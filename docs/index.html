<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sovereign Academy | Ultimate</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --p-blue: #3b82f6; --p-gold: #f59e0b; --p-green: #22c55e; --p-bg: #f8fafc; --p-card: #ffffff; --p-text: #1e293b; }
        body.night-mode { --p-bg: #0f172a; --p-card: #1e293b; --p-text: #f1f5f9; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--p-bg); margin: 0; color: var(--p-text); transition: 0.5s; padding-bottom: 80px; }

        /* Global Chat */
        .ticker-wrap { background: #1e293b; color: #fbbf24; padding: 10px; font-size: 0.8rem; font-weight: 800; overflow: hidden; white-space: nowrap; }
        .ticker { display: inline-block; animation: scroll 25s linear infinite; }
        @keyframes scroll { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

        header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; background: var(--p-card); border-bottom: 1px solid #eee; }
        .logo { font-weight: 900; color: var(--p-blue); font-size: 1.4rem; }
        
        /* Reward Pill */
        .reward-btn { background: #ef4444; color: white; border: none; padding: 10px 15px; border-radius: 50px; font-weight: 800; font-size: 0.7rem; cursor: pointer; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* Main Dragon Card */
        .monster-card { background: var(--p-card); margin: 15px; padding: 30px; border-radius: 40px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.05); position: relative; border: 1px solid #f1f5f9; }
        .m-emoji { font-size: 6rem; cursor: pointer; display: inline-block; transition: 0.3s; }
        .m-name { font-weight: 900; font-size: 1.6rem; margin: 10px 0 5px; color: #334155; }
        .bar-bg { background: #e2e8f0; height: 12px; border-radius: 10px; margin: 15px auto; width: 80%; overflow: hidden; }
        .bar-fill { background: var(--p-green); height: 100%; width: 20%; transition: 1s; }

        /* Grade Selector */
        .grade-bar { display: flex; justify-content: center; gap: 10px; margin: 15px 0; }
        .grade-tab { padding: 8px 15px; border-radius: 12px; font-weight: 800; font-size: 0.7rem; background: #f1f5f9; cursor: pointer; color: #64748b; border: 2px solid transparent; }
        .grade-tab.active { background: white; border-color: var(--p-blue); color: var(--p-blue); }

        /* Mega Activity Grid */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 15px; }
        .act-box { background: var(--p-card); padding: 20px; border-radius: 25px; text-align: center; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.02); border: 1.5px solid #f1f5f9; }
        .act-box:active { transform: scale(0.95); }
        .act-box b { display: block; font-size: 0.8rem; margin-top: 5px; }
        .act-icon { font-size: 2rem; display: block; }

        /* Modal System */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--p-bg); z-index: 2000; display: none; flex-direction: column; padding: 25px; text-align: center; overflow-y: auto; }
        .q-text { font-size: 1.8rem; font-weight: 900; margin: 40px 0; color: var(--p-blue); }
        .opt { background: var(--p-card); border: 2px solid #e2e8f0; padding: 18px; border-radius: 20px; margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; width: 100%; cursor: pointer; }
        .btn-black { background: #1e293b; color: white; padding: 20px; border-radius: 20px; border: none; font-weight: 800; margin-top: auto; }
    </style>
</head>
<body id="body-main">

    <div class="ticker-wrap">
        <div class="ticker">üöÄ GLOBAL: User_Master just unlocked the Dragon Crown! ‚Ä¢ Event: Double Stars in Math Academy! ‚Ä¢ Today's Grade focus: Level 2 Logic ‚Ä¢ </div>
    </div>

    <header>
        <div class="logo" onclick="openParent()">SOVEREIGN</div>
        <button class="reward-btn" id="daily-btn" onclick="claimDaily()">üéÅ DAILY REWARD</button>
        <div style="font-weight: 900;">‚≠ê <span id="s-count">250</span></div>
    </header>

    <div class="monster-card" id="capture-zone">
        <div id="acc-slot" style="font-size: 2.5rem; position: absolute; margin-left: 55px;"></div>
        <div class="m-emoji" onclick="speakPet()" id="pet-img">üê≤</div>
        <div class="m-name" id="pet-name">MASTER DRAGON</div>
        <div style="font-size: 0.7rem; color: #94a3b8; font-weight: 800; margin-bottom: 10px;">GRADE: <span id="grade-display">LEVEL 1</span></div>
        <div class="bar-bg"><div class="bar-fill" id="p-fill"></div></div>
    </div>

    <div class="grade-bar">
        <div class="grade-tab active" onclick="setGrade(1, this)">LEVEL 1</div>
        <div class="grade-tab" onclick="setGrade(2, this)">LEVEL 2</div>
        <div class="grade-tab" onclick="setGrade(3, this)">LEVEL 3</div>
    </div>

    <div class="grid">
        <div class="act-box" onclick="startTest('math')"><span class="act-icon">üî¢</span><b>MATH</b></div>
        <div class="act-box" onclick="startTest('reading')"><span class="act-icon">üìñ</span><b>READING</b></div>
        <div class="act-box" onclick="startTest('science')"><span class="act-icon">üß™</span><b>SCIENCE</b></div>
        <div class="act-box" onclick="startTest('logic')"><span class="act-icon">üß©</span><b>LOGIC</b></div>
        <div class="act-box" onclick="openShop()"><span class="act-icon">üõçÔ∏è</span><b>SHOP</b></div>
        <div class="act-box" onclick="snapPhoto()"><span class="act-icon">üì∏</span><b>PHOTO</b></div>
    </div>

    <div id="test-modal" class="modal">
        <h2 id="test-title">CHALLENGE</h2>
        <div id="q-dots" style="letter-spacing:5px; color:var(--p-gold)"></div>
        <div class="q-text" id="q-txt">Question?</div>
        <div id="options-area"></div>
        <button class="btn-black" onclick="closeAll()">QUIT</button>
    </div>

    <div id="shop-modal" class="modal">
        <h1>WARDROBE</h1>
        <div class="grid">
            <div class="act-box" onclick="buy('üëë')">üëë<br><b>Crown</b></div>
            <div class="act-box" onclick="buy('üï∂Ô∏è')">üï∂Ô∏è<br><b>Shades</b></div>
            <div class="act-box" onclick="buy('üßô')">üßô<br><b>Wizard</b></div>
        </div>
        <button class="btn-black" onclick="closeAll()">CLOSE</button>
    </div>

    <script>
        let stars = 250;
        let currentGrade = 1;
        let qIdx = 0;
        let activeTest = [];

        const bank = {
            math: {
                1: [{q:"1 + 1?", a:"2", o:["1","2","3"]}, {q:"5 - 2?", a:"3", o:["2","3","4"]}],
                2: [{q:"12 + 12?", a:"24", o:["20","24","26"]}, {q:"10 x 5?", a:"50", o:["40","50","60"]}],
                3: [{q:"100 / 4?", a:"25", o:["20","25","30"]}, {q:"12 x 12?", a:"144", o:["124","144","164"]}]
            },
            reading: {
                1: [{q:"A says...", a:"Apple", o:["Apple","Ball","Cat"]}],
                2: [{q:"Opposite of Hot?", a:"Cold", o:["Cold","Warm","Fire"]}],
                3: [{q:"Identify: 'Sovereign'", a:"King", o:["King","Small","Blue"]}]
            }
        };

        function setGrade(n, el) {
            currentGrade = n;
            document.querySelectorAll('.grade-tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
            document.getElementById('grade-display').innerText = "LEVEL " + n;
            speak("Level " + n + " activated");
        }

        function claimDaily() {
            stars += 500;
            updateUI();
            document.getElementById('daily-btn').style.display = 'none';
            speak("Daily reward collected! Five hundred stars added!");
        }

        function speak(t) {
            const u = new SpeechSynthesisUtterance(t); u.pitch = 1.6;
            window.speechSynthesis.speak(u);
        }

        function speakPet() {
            speak("I am your Master Dragon. Let's finish our Level " + currentGrade + " lessons!");
        }

        function startTest(s) {
            activeTest = (bank[s] && bank[s][currentGrade]) ? bank[s][currentGrade] : bank.math[1];
            qIdx = 0;
            document.getElementById('test-modal').style.display = 'flex';
            showQ();
        }

        function showQ() {
            if(qIdx >= activeTest.length) {
                alert("TEST COMPLETE! You earned stars!");
                stars += 400; updateUI(); closeAll(); return;
            }
            let d = activeTest[qIdx];
            document.getElementById('q-txt').innerText = d.q;
            let area = document.getElementById('options-area');
            area.innerHTML = "";
            d.o.forEach(o => {
                let b = document.createElement('button');
                b.className = "opt";
                b.innerText = o;
                b.onclick = () => { if(o === d.a) { qIdx++; showQ(); } else { speak("Try again!"); } };
                area.appendChild(b);
            });
        }

        function updateUI() {
            document.getElementById('s-count').innerText = stars;
            document.getElementById('p-fill').style.width = Math.min((stars/5000)*100, 100) + "%";
        }

        function buy(i) {
            if(stars >= 200) { stars -= 200; document.getElementById('acc-slot').innerText = i; updateUI(); closeAll(); }
            else { alert("Need 200 stars!"); }
        }

        function snapPhoto() {
            html2canvas(document.getElementById('capture-zone')).then(canvas => {
                const link = document.createElement('a'); link.download = 'dragon.png';
                link.href = canvas.toDataURL(); link.click();
            });
        }

        function openParent() {
            let p = prompt("Enter Admin Code (1234):");
            if(p === "1234") { stars += 5000; updateUI(); alert("Admin Mode: 5000 Stars added!"); }
        }

        function openShop() { document.getElementById('shop-modal').style.display = 'flex'; }
        function closeAll() { document.querySelectorAll('.modal').forEach(m => m.style.display='none'); }

        updateUI();
    </script>
</body>
</html>
