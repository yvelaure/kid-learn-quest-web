<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kid Learn Quest</title>
    <style>
        :root { --bg: #f0f9ff; --yellow: #fff176; --green: #81c784; --blue: #64b5f6; --orange: #ffb74d; --purple: #d1c4e9; --pink: #f48fb1; --red: #ff8a80; }
        body { font-family: 'Comic Sans MS', cursive, sans-serif; background: var(--bg); text-align: center; margin: 0; padding: 20px; transition: background 0.5s; overflow-x: hidden; }
        
        /* Animations */
        @keyframes wiggle { 0% { transform: rotate(0deg); } 25% { transform: rotate(3deg); } 75% { transform: rotate(-3deg); } 100% { transform: rotate(0deg); } }
        .wiggle:active { animation: wiggle 0.3s ease infinite; }
        
        header { background: white; padding: 15px; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .stats { font-size: 1.2rem; font-weight: bold; color: #555; display: flex; justify-content: center; gap: 15px; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 400px; margin: auto; }
        .card { background: white; padding: 20px 10px; border-radius: 25px; cursor: pointer; border-bottom: 6px solid #ddd; transition: 0.1s; font-weight: bold; }
        .card:active { transform: translateY(4px); border-bottom-width: 2px; }
        
        .game-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 12px; padding: 10px; justify-content: center; }
        .item-card { background: white; padding: 15px; border-radius: 20px; font-size: 2.5rem; border-bottom: 5px solid #ccc; cursor: pointer; }
        
        .piano { display: flex; justify-content: center; gap: 5px; margin-top: 20px; }
        .key { width: 40px; height: 120px; background: white; border: 2px solid #333; border-radius: 0 0 5px 5px; cursor: pointer; box-shadow: 0 4px #ccc; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; }
        .modal-content { background: white; margin: 20% auto; padding: 30px; width: 80%; max-width: 300px; border-radius: 20px; }

        .hidden { display: none !important; }
        .back-btn { background: #333; color: white; border: none; padding: 12px 25px; border-radius: 50px; margin-bottom: 20px; cursor: pointer; }
        
        /* Colors */
        .yellow { background: var(--yellow); border-color: #fbc02d; }
        .green { background: var(--green); border-color: #388e3c; }
        .blue { background: var(--blue); border-color: #1976d2; }
        .orange { background: var(--orange); border-color: #f57c00; }
        .pink { background: var(--pink); border-color: #f06292; }
        .purple { background: var(--purple); border-color: #9575cd; }
        .red { background: var(--red); border-color: #d32f2f; }

        #paintCanvas { background: white; border: 4px solid #ccc; border-radius: 15px; touch-action: none; width: 100%; max-width: 320px; height: 350px; }
    </style>
</head>
<body>

    <header>
        <h1>‚≠ê Kid Learn Quest</h1>
        <div class="stats">
            <span>üåü <span id="star-count">0</span></span>
            <span>üéØ Level <span id="level-count">1</span></span>
        </div>
    </header>

    <main>
        <section id="menu-view">
            <div class="grid">
                <div class="card yellow wiggle" onclick="goTo('alphabet', 'ABC Time!')">üî§ Letters</div>
                <div class="card green wiggle" onclick="goTo('numbers', '1 2 3 Count!')">üî¢ Numbers</div>
                <div class="card red wiggle" onclick="goTo('animals', 'Listen to the animals!')">ü¶Å Animals</div>
                <div class="card pink wiggle" onclick="goTo('memory', 'Find the matches!')">üß† Memory</div>
                <div class="card blue wiggle" onclick="goTo('shapes', 'Name the shapes!')">üìê Shapes</div>
                <div class="card purple wiggle" onclick="goTo('music', 'Play music!')">üéµ Piano</div>
                <div class="card orange wiggle" onclick="goTo('draw', 'Free paint!')">‚úèÔ∏è Draw</div>
                <div class="card" style="background:#ddd" onclick="openParentGate()">‚öôÔ∏è Settings</div>
            </div>
        </section>

        <section id="alphabet-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="letter-container"></div></section>
        <section id="numbers-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="number-container"></div></section>
        <section id="colors-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="color-container"></div></section>
        <section id="memory-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="memory-container" style="grid-template-columns: repeat(4, 1fr);"></div></section>
        <section id="shapes-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="shape-container"></div></section>
        <section id="animals-view" class="hidden"><button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button><div class="game-grid" id="animal-container"></div></section>
        
        <section id="music-view" class="hidden">
            <button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button>
            <div class="piano">
                <div class="key" onclick="playNote(261, 'Do')"></div>
                <div class="key" onclick="playNote(293, 'Re')"></div>
                <div class="key" onclick="playNote(329, 'Mi')"></div>
                <div class="key" onclick="playNote(349, 'Fa')"></div>
                <div class="key" onclick="playNote(392, 'So')"></div>
                <div class="key" onclick="playNote(440, 'La')"></div>
                <div class="key" onclick="playNote(493, 'Ti')"></div>
            </div>
        </section>

        <section id="draw-view" class="hidden">
            <button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button>
            <canvas id="paintCanvas"></canvas><br><br>
            <button class="back-btn purple" onclick="clearCanvas()">üßº Clear</button>
        </section>

        <section id="parent-view" class="hidden">
            <button class="back-btn" onclick="goTo('menu')">‚¨ÖÔ∏è Back</button>
            <h2>Parent Settings</h2>
            <button class="back-btn orange" onclick="resetStars()">Reset All Stars</button>
        </section>
    </main>

    <div id="parent-modal" class="modal">
        <div class="modal-content">
            <h3>Grown-ups Only</h3>
            <p id="math-question"></p>
            <input type="number" id="gate-answer">
            <br>
            <button class="back-btn" onclick="checkGate()">Unlock</button>
            <button class="back-btn" style="background:#999" onclick="closeGate()">Cancel</button>
        </div>
    </div>

    <script>
        let stars = parseInt(localStorage.getItem('kidStars')) || 0;
        let level = Math.floor(stars / 10) + 1;
        document.getElementById('star-count').innerText = stars;
        document.getElementById('level-count').innerText = level;

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.pitch = 1.4;
            window.speechSynthesis.speak(msg);
        }

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playNote(freq, name) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 1);
            speak(name); addStar();
        }

        function goTo(view, message) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(view + '-view').classList.remove('hidden');
            if (message) speak(message);
            if (view === 'alphabet') createAlphabet();
            if (view === 'numbers') createNumbers();
            if (view === 'animals') createAnimals();
            if (view === 'shapes') createShapes();
            if (view === 'memory') initMemory();
            if (view === 'draw') initDraw();
        }

        function addStar() {
            stars++;
            document.getElementById('star-count').innerText = stars;
            localStorage.setItem('kidStars', stars);
            if (Math.floor(stars / 10) + 1 > level) {
                level++;
                document.getElementById('level-count').innerText = level;
                speak("Level Up! High Five!");
            }
        }

        // --- NEW ANIMAL SECTION ---
        function createAnimals() {
            const container = document.getElementById('animal-container');
            if (container.innerHTML !== "") return;
            const animals = [
                {n:'Lion', e:'ü¶Å', s:'Roar!'}, {n:'Cow', e:'üêÆ', s:'Mooo!'}, 
                {n:'Dog', e:'üê∂', s:'Woof Woof!'}, {n:'Cat', e:'üê±', s:'Meow!'}, 
                {n:'Duck', e:'ü¶Ü', s:'Quack Quack!'}, {n:'Elephant', e:'üêò', s:'Pawoo!'}
            ];
            animals.forEach(a => {
                const div = document.createElement('div');
                div.className = "item-card red wiggle";
                div.innerText = a.e;
                div.onclick = () => { speak(a.n + ". " + a.s); addStar(); };
                container.appendChild(div);
            });
        }

        function createShapes() {
            const container = document.getElementById('shape-container');
            if (container.innerHTML !== "") return;
            const shapes = [{n:'Circle', e:'‚≠ï'}, {n:'Square', e:'üü¶'}, {n:'Triangle', e:'üî∫'}, {n:'Star', e:'‚≠ê'}, {n:'Heart', e:'‚ù§Ô∏è'}];
            shapes.forEach(s => {
                const div = document.createElement('div'); div.className = "item-card blue wiggle";
                div.innerText = s.e; div.onclick = () => { speak(s.n); addStar(); };
                container.appendChild(div);
            });
        }

        function initMemory() {
            const container = document.getElementById('memory-container');
            container.innerHTML = "";
            const icons = ['üçé', 'üçå', 'üçá', 'üçì', 'üçí', 'üçç', 'ü•ù', 'üçâ'];
            let deck = [...icons, ...icons].sort(() => Math.random() - 0.5);
            let flipped = [];
            deck.forEach(icon => {
                const card = document.createElement('div');
                card.className = "item-card purple"; card.style.color = "transparent"; card.innerText = icon;
                card.onclick = function() {
                    if (flipped.length < 2 && !this.classList.contains('matched')) {
                        this.style.color = "black"; flipped.push(this);
                        if (flipped.length === 2) {
                            if (flipped[0].innerText === flipped[1].innerText) {
                                flipped.forEach(c => { c.classList.add('matched'); c.style.background = "#81c784"; });
                                speak("Match!"); addStar(); flipped = [];
                            } else {
                                setTimeout(() => { flipped.forEach(c => c.style.color = "transparent"); flipped = []; }, 800);
                            }
                        }
                    }
                };
                container.appendChild(card);
            });
        }

        function createAlphabet() {
            const container = document.getElementById('letter-container');
            if (container.innerHTML !== "") return;
            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l => {
                const btn = document.createElement('div'); btn.className = "item-card yellow wiggle";
                btn.innerText = l; btn.onclick = () => { speak(l); addStar(); };
                container.appendChild(btn);
            });
        }

        function createNumbers() {
            const container = document.getElementById('number-container');
            if (container.innerHTML !== "") return;
            for (let i = 1; i <= 20; i++) {
                const btn = document.createElement('div'); btn.className = "item-card green wiggle";
                btn.innerText = i; btn.onclick = () => { speak(i.toString()); addStar(); };
                container.appendChild(btn);
            }
        }

        // --- PARENT GATE ---
        let currentGateAnswer = 0;
        function openParentGate() {
            const n1 = Math.floor(Math.random()*10)+1; const n2 = Math.floor(Math.random()*5)+1;
            currentGateAnswer = n1 + n2;
            document.getElementById('math-question').innerText = `Grown-up task: What is ${n1} + ${n2}?`;
            document.getElementById('parent-modal').style.display = 'block';
        }
        function checkGate() {
            if (parseInt(document.getElementById('gate-answer').value) === currentGateAnswer) {
                document.getElementById('parent-modal').style.display = 'none';
                goTo('parent');
            } else { speak("Try again!"); }
        }
        function closeGate() { document.getElementById('parent-modal').style.display = 'none'; }
        function resetStars() { if(confirm("Reset all?")) { localStorage.clear(); location.reload(); } }

        // --- DRAW ---
        let canvas, ctx, painting = false;
        function initDraw() {
            canvas = document.getElementById('paintCanvas'); ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth; canvas.height = canvas.offsetHeight;
            ctx.lineWidth = 10; ctx.lineCap = 'round'; ctx.strokeStyle = '#3498db';
            const start = (e) => { painting = true; draw(e); };
            const end = () => { painting = false; ctx.beginPath(); };
            canvas.onmousedown = start; canvas.onmouseup = end; canvas.onmousemove = draw;
            canvas.ontouchstart = (e) => { e.preventDefault(); start(e.touches[0]); };
            canvas.ontouchend = end; canvas.ontouchmove = (e) => { e.preventDefault(); draw(e.touches[0]); };
        }
        function draw(e) {
            if (!painting) return;
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.pageX) - rect.left;
            const y = (e.clientY || e.pageY) - rect.top;
            ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
        }
        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); speak("All clean!"); }
    </script>
</body>
</html>
