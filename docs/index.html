<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sovereign Photo Mode</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --p-blue: #3498db; --p-green: #2ecc71; --p-gold: #f1c40f; --p-bg: #f8faff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Rounded Mplus 1c', sans-serif; }
        body { background: var(--p-bg); margin: 0; padding-bottom: 80px; }

        /* The Capture Zone (What the photo looks like) */
        #photo-capture-area { 
            background: white; padding: 40px; border-radius: 30px; 
            text-align: center; position: relative; overflow: hidden;
            width: 320px; margin: 20px auto; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .capture-aura { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 200px; height: 200px; border-radius: 50%;
            filter: blur(40px); opacity: 0.3; z-index: 1;
        }
        .capture-monster-stack { position: relative; z-index: 10; display: inline-block; }
        .capture-monster { font-size: 7rem; }
        .capture-acc { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); font-size: 3rem; }

        /* UI Buttons */
        header { background: white; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; }
        .btn-camera { background: #333; color: white; border: none; padding: 12px 25px; border-radius: 50px; font-weight: 900; cursor: pointer; display: flex; align-items: center; gap: 8px; margin: 0 auto; }
        .btn-big { background: var(--p-blue); color: white; border: none; padding: 20px; border-radius: 20px; font-weight: 900; width: 90%; margin: 10px 5%; cursor: pointer; }

        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 5000; display:none; flex-direction: column; padding: 20px; text-align: center; color: white; }
        #preview-img { max-width: 100%; border-radius: 20px; margin: 20px 0; border: 5px solid white; }
    </style>
</head>
<body>

    <header>
        <div style="font-weight:900; color:var(--p-blue)">SOVEREIGN</div>
        <div style="background:#eee; padding:5px 15px; border-radius:20px; font-weight:900;">‚≠ê <span id="stars">250</span></div>
    </header>

    <div id="hub-scr">
        <div id="photo-capture-area">
            <div class="capture-aura" id="v-aura" style="background: var(--p-blue);"></div>
            <div class="capture-monster-stack">
                <div id="v-acc" class="capture-acc">üëë</div>
                <div id="v-icon" class="capture-monster">üê≤</div>
            </div>
            <h2 id="v-name" style="color: #333; margin-top: 20px;">MASTER DRAGON</h2>
            <p style="color: #999; font-size: 0.8rem;">Sovereign Universe Hero</p>
        </div>

        <button class="btn-camera" onclick="takePhoto()">
            üì∑ TAKE A PHOTO
        </button>

        <p style="text-align:center; color:#999; font-size:0.8rem; margin-top:15px;">Your pet will strike a pose!</p>
    </div>

    <div id="photo-modal" class="modal">
        <h2>PHOTO SAVED!</h2>
        <div id="result-container"></div>
        <p>Your Sovereign Monster is now in your gallery!</p>
        <button class="btn-big" onclick="downloadImage()">üíæ DOWNLOAD PHOTO</button>
        <button class="btn-big" style="background:none; color:white; border: 2px solid white;" onclick="closePhoto()">CLOSE</button>
    </div>

    <script>
        // Use the stars and evolution logic from previous builds
        let stars = 1500; 

        function takePhoto() {
            // "Strike a pose" animation
            const area = document.getElementById('photo-capture-area');
            area.style.transform = "scale(1.05)";
            
            // Generate the image
            html2canvas(area).then(canvas => {
                const imgData = canvas.toDataURL("image/png");
                const container = document.getElementById('result-container');
                container.innerHTML = `<img src="${imgData}" id="preview-img">`;
                
                document.getElementById('photo-modal').style.display = 'flex';
                area.style.transform = "scale(1)";
                
                // Voice feedback
                const ut = new SpeechSynthesisUtterance("Smile! What a great photo!");
                window.speechSynthesis.speak(ut);
            });
        }

        function downloadImage() {
            const img = document.getElementById('preview-img').src;
            const link = document.createElement('a');
            link.download = 'my-sovereign-pet.png';
            link.href = img;
            link.click();
        }

        function closePhoto() {
            document.getElementById('photo-modal').style.display = 'none';
        }

        // Logic to keep the photo area updated with current evolution/items
        function syncPhotoData(mon, acc, name, auraColor) {
            document.getElementById('v-icon').innerText = mon;
            document.getElementById('v-acc').innerText = acc;
            document.getElementById('v-name').innerText = name;
            document.getElementById('v-aura').style.background = auraColor;
        }
    </script>
</body>
</html>
