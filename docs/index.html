<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sovereign Nexus Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { 
            --accent: #6366f1; --gold: #f59e0b; --green: #10b981;
            --bg: #f1f5f9; --card: rgba(255, 255, 255, 0.9); --text: #0f172a;
        }
        body.dark { --bg: #020617; --card: rgba(30, 41, 59, 0.8); --text: #f8fafc; }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'SF Pro Display', system-ui, sans-serif; }
        body { background: var(--bg); color: var(--text); margin: 0; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow-x: hidden; }

        /* --- AUTH SCREEN --- */
        #auth-gate {
            position: fixed; inset: 0; z-index: 9999; background: linear-gradient(135deg, #4338ca, #6366f1);
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px);
            padding: 40px; border-radius: 40px; border: 1px solid rgba(255,255,255,0.2);
            width: 100%; max-width: 350px; text-align: center;
        }

        /* --- DASHBOARD UI --- */
        header { 
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 100;
        }
        .stats-pill { 
            background: var(--card); padding: 10px 20px; border-radius: 30px; 
            font-weight: 800; border: 1px solid rgba(0,0,0,0.05); display: flex; align-items: center; gap: 8px;
        }

        .pet-stage-card {
            margin: 20px; padding: 50px 20px; border-radius: 40px;
            background: var(--card); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
            position: relative; overflow: hidden; text-align: center;
        }
        .glow {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 200px; height: 200px; border-radius: 50%; filter: blur(60px); opacity: 0.2;
            background: var(--accent); transition: 1s;
        }
        .pet-sprite { font-size: 8rem; position: relative; z-index: 5; cursor: pointer; transition: 0.3s; }
        .pet-sprite:hover { transform: scale(1.1) rotate(5deg); }

        /* --- NAVIGATION --- */
        .nav-tabs { display: flex; justify-content: center; gap: 12px; margin: 10px 0; }
        .tab { 
            padding: 14px 24px; border-radius: 20px; border: none; font-weight: 700;
            background: var(--card); color: var(--text); cursor: pointer; transition: 0.3s;
        }
        .tab.active { background: var(--accent); color: white; transform: translateY(-3px); }

        /* --- GRID SYSTEM --- */
        .island-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 20px; }
        .island {
            background: var(--card); border-radius: 35px; padding: 30px 15px;
            text-align: center; border: 1px solid rgba(0,0,0,0.03); transition: 0.3s;
        }
        .island:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .icon-circle { 
            font-size: 2.5rem; width: 70px; height: 70px; background: rgba(99, 102, 241, 0.1);
            border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;
        }

        /* --- MODAL ENGINE --- */
        .modal {
            position: fixed; inset: 0; background: var(--bg); z-index: 5000;
            display: none; flex-direction: column; padding: 40px 20px; overflow-y: auto;
        }
        .q-text { font-size: 2.5rem; font-weight: 900; margin-bottom: 40px; }
        .ans-btn {
            background: var(--card); border: 2px solid rgba(0,0,0,0.05); 
            padding: 25px; border-radius: 25px; margin-bottom: 15px;
            font-size: 1.4rem; font-weight: 800; width: 100%; text-align: center;
        }
        .ans-btn:active { background: var(--accent); color: white; }

        .progress-container { width: 80%; height: 10px; background: #e2e8f0; border-radius: 10px; margin: 20px auto; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--green); transition: 0.5s; }
    </style>
</head>
<body id="app-root">

    <div id="auth-gate">
        <div class="glass-panel">
            <h1 style="font-size: 2.5rem; margin-bottom: 10px;">SOVEREIGN</h1>
            <p>The Future of Learning</p>
            <input type="text" id="name-in" placeholder="Student Name" style="width:100%; padding:15px; border-radius:15px; border:none; margin:20px 0; font-size:1.1rem; text-align:center;">
            <button onclick="bootApp()" style="width:100%; padding:18px; border-radius:15px; border:none; background:var(--gold); font-weight:900; font-size:1.1rem;">INITIALIZE</button>
        </div>
    </div>

    <header>
        <div class="stats-pill" onclick="openReport()">üë§ <span id="user-display">Explorer</span></div>
        <div class="stats-pill">‚≠ê <span id="star-count">0</span></div>
    </header>

    <div class="pet-stage-card">
        <div class="glow" id="aura"></div>
        <div id="acc-layer" style="position:absolute; top:40px; left:50%; transform:translateX(-50%); font-size:3rem; z-index:10;"></div>
        <div class="pet-sprite" id="pet" onclick="speak('Ready for a challenge?')">ü•ö</div>
        <h2 id="stage-label" style="text-transform:uppercase; letter-spacing:2px;">EGG STAGE</h2>
        <div class="progress-container"><div class="progress-bar" id="p-fill" style="width: 0%;"></div></div>
    </div>

    <div class="nav-tabs">
        <button class="tab active" onclick="setGrade(1, this)">LVL 1</button>
        <button class="tab" onclick="setGrade(2, this)">LVL 2</button>
        <button class="tab" onclick="setGrade(3, this)">LVL 3</button>
    </div>

    <div class="island-grid">
        <div class="island" onclick="launchQuest('Math')"><div class="icon-circle">‚ûï</div><b>MATH</b></div>
        <div class="island" onclick="launchQuest('Reading')"><div class="icon-circle">üìñ</div><b>READING</b></div>
        <div class="island" onclick="launchQuest('Science')"><div class="icon-circle">üî¨</div><b>SCIENCE</b></div>
        <div class="island" onclick="openLibrary()"><div class="icon-circle">üìö</div><b>LIBRARY</b></div>
        <div class="island" onclick="openShop()"><div class="icon-circle">üíé</div><b>CLOSET</b></div>
        <div class="island" onclick="toggleDark()"><div class="icon-circle">üåô</div><b>THEME</b></div>
    </div>

    <div id="quest-modal" class="modal">
        <div id="q-title" style="color:var(--accent); font-weight:900;">LEVEL 1 MATH</div>
        <div class="q-text" id="q-body">What is 10 + 5?</div>
        <div id="options-box"></div>
        <button onclick="closeModals()" style="margin-top:auto; background:none; border:none; color:#94a3b8; font-weight:700;">QUIT SESSION</button>
    </div>

    <div id="report-modal" class="modal">
        <h1>ACADEMIC REPORT</h1>
        <div style="background:var(--card); padding:20px; border-radius:20px; text-align:left; margin-bottom:20px;">
            <p><b>STUDENT:</b> <span id="rep-name"></span></p>
            <p><b>MASTERY STARS:</b> <span id="rep-stars"></span></p>
            <p><b>LEVEL ACHIEVED:</b> <span id="rep-level"></span></p>
        </div>
        <button class="ans-btn" style="background:var(--green); color:white; border:none;" onclick="addStars(5000)">+5,000 ADMIN STARS</button>
        <button class="ans-btn" onclick="closeModals()">RETURN</button>
    </div>

    <script>
        let state = {
            name: "Explorer", stars: 250, grade: 1, completed: 0, 
            theme: 'light', accessory: ''
        };

        const bank = {
            Math: {
                1: [{q:"1+5?", a:"6", o:["4","6","8"]}, {q:"10-3?", a:"7", o:["5","7","9"]}],
                2: [{q:"12 x 2?", a:"24", o:["22","24","26"]}, {q:"50 + 75?", a:"125", o:["115","125","135"]}],
                3: [{q:"Square of 5?", a:"25", o:["10","20","25"]}, {q:"144 / 12?", a:"12", o:["10","12","14"]}]
            },
            Reading: {
                1: [{q:"Sound of 'C'?", a:"Cat", o:["Cat","Ant"]}],
                2: [{q:"Opposite: FAST", a:"Slow", o:["Quick","Slow"]}],
                3: [{q:"What is a VERB?", a:"Run", o:["Run","Book","Blue"]}]
            },
            Science: {
                1: [{q:"Sun is a...", a:"Star", o:["Planet","Star"]}],
                2: [{q:"Ice is...", a:"Solid", o:["Solid","Gas"]}],
                3: [{q:"Moon orbits...", a:"Earth", o:["Sun","Earth"]}]
            }
        };

        function bootApp() {
            const input = document.getElementById('name-in').value;
            if(!input) return alert("Enter your name, Hero!");
            state.name = input;
            document.getElementById('user-display').innerText = state.name;
            document.getElementById('auth-gate').style.display = 'none';
            speak("Welcome " + state.name);
            updateUI();
        }

        function setGrade(g, el) {
            state.grade = g;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
            speak("Level " + g + " active");
        }

        function launchQuest(type) {
            const quests = bank[type][state.grade];
            let current = 0;
            const modal = document.getElementById('quest-modal');
            modal.style.display = 'flex';
            
            function render() {
                if(current >= quests.length) {
                    addStars(500); state.completed++;
                    closeModals(); alert("Mastery Achieved!"); return;
                }
                document.getElementById('q-title').innerText = `LEVEL ${state.grade} ${type}`;
                document.getElementById('q-body').innerText = quests[current].q;
                const box = document.getElementById('options-box');
                box.innerHTML = "";
                quests[current].o.forEach(o => {
                    const b = document.createElement('button');
                    b.className = "ans-btn"; b.innerText = o;
                    b.onclick = () => { if(o === quests[current].a) { current++; render(); } else { speak("Try again!"); } };
                    box.appendChild(b);
                });
            }
            render();
        }

        function addStars(amt) { state.stars += amt; updateUI(); }

        function updateUI() {
            document.getElementById('star-count').innerText = state.stars;
            const p = Math.min((state.stars / 5000) * 100, 100);
            document.getElementById('p-fill').style.width = p + "%";
            
            const pet = document.getElementById('pet');
            const label = document.getElementById('stage-label');
            const aura = document.getElementById('aura');

            if(state.stars < 1000) { pet.innerText = "ü•ö"; label.innerText = "Egg Stage"; aura.style.background = "#6366f1"; }
            else if(state.stars < 3000) { pet.innerText = "üê£"; label.innerText = "Guardian Hatchling"; aura.style.background = "#10b981"; }
            else { pet.innerText = "üê≤"; label.innerText = "Sovereign Dragon"; aura.style.background = "#f59e0b"; }
        }

        function openReport() {
            document.getElementById('rep-name').innerText = state.name;
            document.getElementById('rep-stars').innerText = state.stars;
            document.getElementById('rep-level').innerText = "Grade " + state.grade;
            document.getElementById('report-modal').style.display = 'flex';
        }

        function speak(t) { window.speechSynthesis.speak(new SpeechSynthesisUtterance(t)); }
        function toggleDark() { document.body.classList.toggle('dark'); }
        function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }
        function openShop() { alert("Closet Unlocks at 1000 Stars!"); }
        function openLibrary() { alert("Library Stories coming in next update!"); }
    </script>
</body>
</html>
